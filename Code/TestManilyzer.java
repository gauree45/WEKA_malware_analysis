import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.OutputStream;
import java.io.PrintStream;

public class TestManilyzer {

	/**
	 * @param args
	 * @throws Exception
	 */
	public static void main(String[] args) throws Exception {

		System.out.println(" MANILYZER  TESTING");
		FeatureExtraction F1 = new FeatureExtraction();
		System.out.println("GENERATE FEATURE VECTOR FILE (CSV) CONTAINING "
				+ F1.getFeature_count("C://Manilyzer//Feature_List.txt")
				+ " FEATURES");
		System.out.println("");

		PrintStream console = System.err;

		File error = new File("err.txt");
		FileOutputStream fos = new FileOutputStream(error);
		PrintStream ps = new PrintStream(fos);
		System.setErr(ps);

		/* Malware Human Readable XML files */
		File malware_folder = new File("C://Manilyzer//data//malware");
		File[] list_of_files_malware = malware_folder.listFiles();

		/* Benign Human Readable XML file */
		File benign_folder = new File("C://Manilyzer//data//benign");
		File[] list_of_files_benign = benign_folder.listFiles();

		int file_exists = F1.CreateFeatureCSV("C://Manilyzer",
				"C://Manilyzer//Feature_List.txt");

		System.out.println("");
		if (file_exists == 1) {
			System.out.println("GENERATE FEATURE VECTOR FOR MALWARE SAMPLES ");

			for (File file : list_of_files_malware) {
				if (file.getTotalSpace() > 0)
					F1.generateFeatureVector(file.getPath(), true,
							file.getName());

			}

			System.out.println("GENERATE FEATURE VECTOR FOR BENIGN SAMPLES ");
			for (File file : list_of_files_benign) {
				if (file.getTotalSpace() > 0)
					F1.generateFeatureVector(file.getPath(), false,
							file.getName());

			}
		}

		else {
			System.out.println("FEATURE VECTOR FILE ALREADY EXISTS ");
		}

		System.out.println();
		System.out.println("SMS MALWARES CONTAINED IN THE MALWARE DUMP ");

		SMSMalwareDetection sms = new SMSMalwareDetection();

		for (File file : list_of_files_malware) {
			if (file.getTotalSpace() > 0)

				sms.DetermineSMSMalware(file.getPath(), true, file.getName());
		}

		FeatureClassification classify = new FeatureClassification();
		System.out.println("");
		System.out.println("FEATURE CLASSIFICATION");
		System.out.println();
		System.out.println("NAIVE BAYES FEATURE CLASSIFICATION");
		classify.classifyNaiveBayes("C://Manilyzer");

		System.out.println("J48 FEATURE CLASSIFICATION");
		classify.classifyJ48Trees("C://Manilyzer");

	}

}
